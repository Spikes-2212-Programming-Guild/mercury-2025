<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generated Page</title>
</head>
<body>
    <p>Enter text</p>
    <input type="text" id="username" />

	<p>Enter your favorite color</p>
    <input type="text" id="color" />

    <button onclick="submit()">submit</button>

    <button onclick="toData()">toData</button>

</body>
<script>
    // Get all question elements
    const questions = [document.getElementById('username'), document.getElementById('color')];

    // Set initial values from sessionStorage and add input event listeners
    questions.forEach(q => {
        const storedValue = window.sessionStorage.getItem(q.id);
        if (storedValue) {
            q.value = storedValue;
        }

        q.addEventListener('input', (event) => {
            window.sessionStorage.setItem(event.target.id, event.target.value);
        });
    });

    async function toData() {
        window.location.href = '/data';
    }

    async function submit() {

        const formData = {};

        questions.forEach(q => {
            formData[q.id] = q.value;
        });

        console.log(formData);

        try {
            const response = await fetch("http://localhost:3000/submit", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(formData),
            });

            if (response.ok) {
                alert("Form data inserted successfully");
            } else {
                alert("Error inserting form data");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Error inserting form data");
        }
    }

</script>
</html>